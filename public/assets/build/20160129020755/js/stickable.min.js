"use strict";function alertSuccess(message){Messenger().post({message:message,type:"success",showCloseButton:!0,hideAfter:5})}function alertError(message){Messenger().post({message:message,type:"error",showCloseButton:!0})}var app=angular.module("stickable",["ui.router","ngResource","ngSanitize","LocalStorageModule","angularModalService","ngAnimate"]);app.config(function($httpProvider,$locationProvider,$stateProvider,$urlRouterProvider,localStorageServiceProvider){$locationProvider.html5Mode(!0),localStorageServiceProvider.setPrefix("stickable").setStorageType("localStorage").setStorageCookie(0,"/"),$stateProvider.state("home",{url:"/",templateUrl:"views/pages/home.html",controller:"HomeController"}).state("help",{url:"/help",templateUrl:"views/pages/help.html"}).state("browse",{url:"/browse",templateUrl:"views/pages/browse.html",controller:"BrowseController"}).state("bot",{url:"/bot",templateUrl:"views/pages/bot.html",controller:"BotController"}).state("signup",{url:"/signup",templateUrl:"views/pages/auth/signup.html",controller:"SignupController"}).state("login",{url:"/login",templateUrl:"views/pages/auth/login.html",controller:"LoginController",params:{loginFormData:null,response:null}}).state("forgot",{url:"/forgot",templateUrl:"views/pages/auth/forgot.html",controller:"ForgotController"}).state("reset",{url:"/reset/{token:string}",templateUrl:"views/pages/auth/reset.html",controller:"ResetController"}).state("settings",{url:"/settings",templateUrl:"views/pages/settings/index.html",controller:"SettingsController"}).state("user",{url:"/user/{username:string}",templateUrl:"views/pages/user/view.html",controller:"UserProfileController"}).state("user-todo",{url:"/user/{username:string}/todo",templateUrl:"views/pages/user/todo.html",controller:"UserToDoController"}).state("user-stickers",{url:"/user/{username:string}/stickers",templateUrl:"views/pages/user/stickers.html",controller:"UserStickersController"}).state("category",{url:"/category/{slug:string}",templateUrl:"views/pages/category/view.html",controller:"CategoryController"}).state("sticker",{url:"/sticker/{slug:string}",templateUrl:"views/pages/sticker/view.html",controller:"StickerController"}).state("task",{url:"/task/{slug:string}",templateUrl:"views/pages/task/view.html",controller:"TaskController"}).state("post",{url:"/task/{slug:string}/{postSlug:string}",templateUrl:"views/pages/task/view.html",controller:"TaskController"}),$urlRouterProvider.otherwise("/")}),app.run(function($rootScope,$state,AuthService,UserNotificationsResource){FastClick.attach(document.body),$rootScope.$state=$state,$rootScope.pageTitle="",AuthService.checkSession(),$rootScope.currentUser=AuthService.getUser(),$rootScope.notifications=[],$rootScope.$on("login",function(event,args){$rootScope.currentUser=args.user,$rootScope.notifications=UserNotificationsResource.query({username:args.user.username})}),$rootScope.$on("logout",function(){$rootScope.currentUser=!1}),$rootScope.$on("$stateChangeSuccess",function(ev,to,toParams,from){$("body").removeClass("navbar-visible").attr("data-previous",from.name),document.body.scrollTop=document.documentElement.scrollTop=0})}),$(document).on("click","body:not(.navbar-visible) .navbar-toggle",function(e){console.log(e),e.preventDefault(),$("body").addClass("navbar-visible")}),$(document).on("click","body.navbar-visible .navbar-toggle",function(e){e.preventDefault(),$("body").removeClass("navbar-visible")}),$(document).on("click","body.navbar-visible",function(e){$(e.target).closest("#top-bar-nav").length>0||$(e.target).closest("button").hasClass("navbar-toggle")||$(e.target).hasClass("navbar-toggle")||(e.preventDefault(),$("body").removeClass("navbar-visible"))}),angular.module("stickable").run(["$templateCache",function($templateCache){$templateCache.put("views/pages/auth/forgot.html",'<div class="container">\n    <div class="row">\n        <div class="col-md-8 col-md-offset-2">\n            <div class="panel panel-default">\n                <div class="panel-heading"><h1>Forgotten Login Details</h1></div>\n                <div class="panel-body">\n\n                    <form class="form-horizontal" role="form" ng-submit="submit()">\n\n                        <div class="form-group" ng-class="{\'has-error\': forgotFormData.errors.email}" ng-if="!success">\n                            <label class="col-md-4 control-label">E-Mail Address</label>\n\n                            <div class="col-md-6">\n                                <input type="email"\n                                       class="form-control"\n                                       name="email"\n                                       required\n                                       ng-model="forgotFormData.email"/>\n\n                                <span ng-if="forgotFormData.errors.email" class="help-block">{{ forgotFormData.errors.email.join(\' \') }}</span>\n                            </div>\n                        </div>\n\n                        <div class="form-group" ng-if="!success">\n                            <div class="col-md-6 col-md-offset-4">\n                                <button type="submit" class="btn btn-primary">\n                                    <i class="fa fa-envelope"\n                                       ng-hide="forgotFormData.loading"></i><i class="fa fa-spinner fa-spin"\n                                                                               ng-show="forgotFormData.loading"></i>\n                                    Send Password Reset Link\n                                </button>\n                            </div>\n                        </div>\n\n                        <div class="alert alert-success" ng-if="success">\n                            <i class="fa fa-envelope"></i> Your details have been sent to <strong>{{\n                            forgotFormData.email }}</strong>.\n                        </div>\n\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("views/pages/auth/login.html",'<div class="container">\n\n    <div class="row">\n        <div class="col-md-8 col-md-offset-2">\n            <div class="panel panel-default">\n                <div class="panel-heading"><h1>Login</h1></div>\n                <div class="panel-body">\n\n                    <form class="form-horizontal" role="form" ng-submit="login()">\n\n                        <div class="form-group" ng-class="{\'has-error\': loginFormData.errors.username}">\n\n                            <label class="col-md-4 control-label">Username <i class="fa fa-user"></i></label>\n\n                            <div class="col-md-8">\n                                <input type="username"\n                                       class="form-control"\n                                       name="username"\n                                       value=""\n                                       required\n                                       ng-model="loginFormData.username"/>\n\n                                <span ng-if="loginFormData.errors.username" class="help-block">{{ loginFormData.errors.username.join(\' \') }}</span>\n\n                            </div>\n                        </div>\n\n                        <div class="form-group" ng-class="{\'has-error\': loginFormData.errors.password}">\n                            <label class="col-md-4 control-label">Password <i class="fa fa-key"></i></label>\n\n                            <div class="col-md-8">\n                                <input type="password"\n                                       class="form-control"\n                                       name="password"\n                                       required\n                                       ng-model="loginFormData.password"/>\n\n                                <span ng-if="loginFormData.errors.password" class="help-block">{{ loginFormData.errors.password.join(\' \') }}</span>\n\n                            </div>\n                        </div>\n\n                        <div class="form-group">\n                            <div class="col-md-8 col-md-offset-4">\n                                <button type="submit" class="btn btn-primary">\n                                    <i class="fa fa-key"\n                                       ng-hide="loginFormData.loading"></i><i class="fa fa-spinner fa-spin"\n                                                                              ng-show="loginFormData.loading"></i> Login\n                                </button>\n\n                                <a href="/forgot" class="btn">Forgot Details?</a>\n                            </div>\n                        </div>\n\n                    </form>\n\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>\n'),$templateCache.put("views/pages/auth/reset.html",'<div class="container">\n    <div class="row">\n        <div class="col-md-8 col-md-offset-2">\n            <div class="panel panel-default">\n                <div class="panel-heading"><h1>Create A New Password</h1></div>\n                <div class="panel-body">\n\n                    <form class="form-horizontal" role="form" ng-submit="submit()">\n\n                        <input type="hidden" name="token" ng-model="resetFormData.token">\n\n                        <div class="form-group"\n                             ng-class="{\'has-error\': resetFormData.errors.password}"\n                             ng-if="!success">\n                            <label for="password" class="col-md-4 control-label">Password</label>\n\n                            <div class="col-md-6">\n                                <input type="password"\n                                       class="form-control"\n                                       id="password"\n                                       name="password"\n                                       ng-model="resetFormData.password"\n                                       required>\n\n                                <span ng-if="resetFormData.errors.password" class="help-block">{{ resetFormData.errors.password.join(\' \') }}</span>\n                            </div>\n                        </div>\n\n                        <div class="form-group"\n                             ng-class="{\'has-error\': resetFormData.errors.confirmPassword}"\n                             ng-if="!success">\n                            <label for="confim-password" class="col-md-4 control-label">Confirm Password</label>\n\n                            <div class="col-md-6">\n                                <input type="password"\n                                       class="form-control"\n                                       id="confim-password"\n                                       name="confim-password"\n                                       ng-model="resetFormData.confirmPassword"\n                                       required>\n\n                                <span ng-if="resetFormData.errors.confirmPassword" class="help-block">{{ resetFormData.errors.confirmPassword.join(\' \') }}</span>\n                            </div>\n                        </div>\n\n                        <div class="form-group" ng-if="!success">\n                            <div class="col-md-6 col-md-offset-4">\n                                <button type="submit" class="btn btn-primary">\n                                    <i class="fa fa-unlock-alt"\n                                       ng-hide="resetFormData.loading"></i><i class="fa fa-spinner fa-spin"\n                                                                              ng-show="resetFormData.loading"></i> Reset\n                                    Password\n                                </button>\n                            </div>\n                        </div>\n\n                        <div class="alert alert-success" ng-if="success">\n                            <i class="fa fa-check"></i> Password changed. You can now <a class="btn"\n                                                                                         href="/login">Login</a> with\n                            the new password.\n                        </div>\n\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),$templateCache.put("views/pages/auth/signup.html",'<div class="container">\n    <div class="row">\n        <div class="col-md-8 col-md-offset-2">\n            <div class="panel panel-default">\n                <div class="panel-heading"><h1>Create An Account</h1></div>\n                <div class="panel-body">\n\n                    <form class="form-horizontal" role="form" ng-submit="signup()">\n\n                        <div class="form-group" ng-class="{\'has-error\': signupFormData.errors.username}">\n                            <label class="col-md-4 control-label">Username <i class="fa fa-user"></i></label>\n\n                            <div class="col-md-8">\n                                <input type="text"\n                                       class="form-control"\n                                       name="username"\n                                       ng-model="signupFormData.username"\n                                       required/>\n                                <span ng-if="signupFormData.errors.username" class="help-block">{{ signupFormData.errors.username.join(\' \') }}</span>\n                            </div>\n                        </div>\n\n                        <div class="form-group" ng-class="{\'has-error\': signupFormData.errors.email}">\n                            <label class="col-md-4 control-label">E-Mail Address <i class="fa fa-envelope"></i></label>\n\n                            <div class="col-md-8">\n                                <input type="email"\n                                       class="form-control"\n                                       name="email"\n                                       ng-model="signupFormData.email"\n                                       required/>\n                                <span ng-if="signupFormData.errors.email" class="help-block">{{ signupFormData.errors.email.join(\' \') }}</span>\n                            </div>\n                        </div>\n\n                        <div class="form-group" ng-class="{\'has-error\': signupFormData.errors.password}">\n                            <label class="col-md-4 control-label">Password <i class="fa fa-key"></i></label>\n\n                            <div class="col-md-8">\n                                <input type="password"\n                                       class="form-control"\n                                       name="password"\n                                       ng-model="signupFormData.password"\n                                       required/>\n                                <span ng-if="signupFormData.errors.password" class="help-block">{{ signupFormData.errors.password.join(\' \') }}</span>\n                            </div>\n                        </div>\n\n                        <div class="form-group">\n                            <div class="col-md-8 col-md-offset-4">\n                                <button type="submit" class="btn btn-primary">\n                                    <i class="fa fa-user fa-fw"\n                                       ng-hide="signupFormData.loading"></i><i class="fa fa-spinner fa-spin fa-fw"\n                                                                               ng-show="signupFormData.loading"></i>\n                                    Signup\n                                </button>\n                            </div>\n                        </div>\n\n                    </form>\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n'),$templateCache.put("views/pages/bot.html",'<div class="content">\n<div class="container">\n    <h2>Hi, I\'m Stickerbot</h2>\n\n    <p>I\'ll help you find something to do and stickers to work towards from your budget and available time.</p>\n    <img src="/assets/img/bot.png"/>\n\n    <p>//TODO</p>\n</div>\n</div>\n'),$templateCache.put("views/pages/browse.html",'<ul class="category-list row">\n    <li class="col-sm-3 col-xs-6" ng-repeat="category in categories">\n        <a href="/category/{{ category.slug }}" ng-style="{\'background-image\':\'url(\'+category.thumbUrl+\')\'}">\n            <span>{{ category.name }}</span>\n        </a>\n    </li>\n</ul>\n\n'),$templateCache.put("views/pages/category/view.html",'<h1>{{ category.name }}</h1>\n\n<ul ng-if="hasSubcategories" class="category-list row">\n    <li class="col-sm-3 col-xs-6" ng-repeat="subcategory in category.subcategories">\n        <a href="/category/{{ subcategory.slug }}" ng-style="{\'background-image\':\'url(\'+subcategory.thumbUrl+\')\'}">\n            <span>{{ subcategory.name }}</span>\n        </a>\n    </li>\n</ul>\n\n<ul ng-if="hasStickers" class="sticker-list row">\n\n    <li class="col-md-2" ng-repeat="sticker in category.stickers">\n        <a href="/sticker/{{ sticker.slug }}">\n            <span class="sticker" img="{{ sticker.design.imageUrl }}"></span>\n            <h3>{{ sticker.name }}</h3>\n        </a>\n    </li>\n\n</ul>\n\n<div ng-if="category && !hasSubcategories && !hasStickers" class="container">\n    <div class="alert alert-danger">\n        <p><i class="fa fa-frown-o"></i> There\'s nothing in this category yet.</p>\n    </div>\n</div>\n'),$templateCache.put("views/pages/help.html",'<div class="content">\n<div class="container">\n    <h1>About Stickable</h1>\n\n    <section id="how-it-works">\n        <div class="container">\n\n            <h2>How Stickable Works</h2>\n\n            <div class="row">\n\n                <div class="col-md-3">\n                    <i class="fa fa-5x fa-trophy"></i>\n\n                    <h3>Choose Stickers<span>To Work Towards</span></h3>\n                </div>\n\n                <div class="col-md-3">\n                    <i class="fa fa-5x fa-check-square-o"></i>\n\n                    <h3>Do The Tasks<span>Make Something, Visit Somewhere, Do Something!</span></h3>\n                </div>\n\n                <div class="col-md-3">\n                    <i class="fa fa-5x fa-camera-retro"></i>\n\n                    <h3>Submit Photos<span>Or Other Evidence Of You Doing The Tasks</span></h3>\n                </div>\n\n                <div class="col-md-3">\n                    <i class="fa fa-5x fa-certificate"></i>\n\n                    <h3>Receive Stickers<span>In The Mail</span></h3>\n                </div>\n\n                <div class="col-md-4">\n\n                </div>\n            </div>\n\n        </div>\n    </section>\n\n\n    <h1>This is an h1 heading</h1>\n\n    <h2>This is an h2 heading</h2>\n\n    <h3>This is an h3 heading</h3>\n    <h4>This is an h4 heading</h4>\n    <h5>This is an h5 heading</h5>\n\n    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam metus felis, egestas a sem et, lobortis venenatis\n        libero. Nunc vitae justo eget lectus scelerisque faucibus vel ac felis. Sed iaculis leo vitae pulvinar\n        dignissim. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Praesent at\n        enim egestas, convallis erat at, pellentesque arcu. Nunc rutrum sem vitae orci mollis feugiat. Aenean ante\n        ipsum, aliquam vel imperdiet id, pulvinar vel lectus. Sed sagittis elit non ipsum porta, in luctus tellus\n        efficitur. Nunc turpis metus, volutpat sit amet ante eu, sollicitudin vulputate lacus. Duis sit amet sem a nunc\n        euismod posuere at vel justo. Integer condimentum sollicitudin lacus, sed sollicitudin dui efficitur eget.\n        Suspendisse at vehicula risus. Donec nec dui in arcu consequat tincidunt. Nullam gravida eros elit, vitae\n        venenatis risus mattis vel. Donec ut sollicitudin nibh, vel scelerisque sem.</p>\n\n    <h2>Button Examples</h2>\n\n    <p class="text-center">\n        <a href="#" class="btn">Blue buttons go to another page</a>\n        <a href="#" class="btn btn-primary">Purple buttons do an action right now</a>\n\n        <a href="#" class="btn btn-danger">Do something bad</a>\n        <a href="#" class="btn btn-success">Do something good</a>\n        <a href="#" class="btn btn-warning">Do something medium</a>\n    </p>\n\n    <p class="text-center">\n        <a href="#" class="btn btn-blue btn-lg">btn-lg</a>\n        <a href="#" class="btn btn-blue">btn</a>\n        <a href="#" class="btn btn-blue btn-sm">btn-sm</a>\n    </p>\n</div>\n</div>\n'),$templateCache.put("views/pages/home.html",'<div class="splash-bg" ng-style="{ \'background-image\': \'url(\' + splashImage + \')\'}"></div>\n<div class="splash home-splash">\n    <div class="container">\n        <div class="row">\n            <div class="col-sm-4">\n                <img src="/assets/img/stickable.png" alt="Stickable" id="home-splash-logo"/>\n            </div>\n            <div class="col-sm-8 text-shadow">\n                <h2>Discover new hobbies. Get help from our community. Earn real-life stickers to show off your\n                    progress.</h2>\n\n                <div class="row btn-row">\n                    <div class="col-xs-7">\n                        <a class="btn btn-primary" href="/bot"><i class="fa fa-play-circle"></i> Find Something To\n                            Do</a>\n                    </div>\n                    <div class="col-xs-5">\n                        <a class="btn" href="/help"><i class="fa fa-info"></i> Learn More</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="content">\n    <div class="container-fluid">\n        <ng-include src="\'views/partials/post-list.html\'"></ng-include>\n    </div>\n</div>\n'),$templateCache.put("views/pages/settings/index.html",'<div class="container">\n    <h1>Settings</h1>\n\n    <form class="form-horizontal" role="form" ng-submit="submit()">\n\n        <div class="form-group" ng-class="{\'has-error\': settingsFormData.errors.picture}">\n            <label class="col-md-4 control-label">Picture <i class="fa fa-picture"></i></label>\n\n            <div class="col-md-8">\n\n                <input type="text" class="form-control" name="picture" ng-model="settingsFormData.picture"/>\n                <span ng-if="settingsFormData.errors.picture" class="help-block">{{ settingsFormData.errors.picture.join(\' \') }}</span>\n\n                <a href="#"\n                   class="btn"\n                   id="settings-upload-picture-btn"\n                   ng-click="uploadPicture()"><i class="fa fa-camera"></i> Upload new picture</a>\n\n\n                <img ng-src="{{ settingsFormData.picture }} id=" settings-picture" />\n\n            </div>\n        </div>\n\n        <div class="form-group" ng-class="{\'has-error\': settingsFormData.errors.about}">\n            <label class="col-md-4 control-label">About Me <i class="fa fa-about"></i></label>\n\n            <div class="col-md-8">\n                <textarea class="form-control" name="about" ng-model="settingsFormData.about"></textarea>\n                <span ng-if="settingsFormData.errors.about" class="help-block">{{ settingsFormData.errors.about.join(\' \') }}</span>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <div class="col-md-8 col-md-offset-4">\n                <button type="submit" class="btn btn-success">Save Changes</button>\n            </div>\n        </div>\n\n    </form>\n</div>\n'),$templateCache.put("views/pages/sticker/view.html",'<div class="content">\n<div class="splash sticker-splash" ng-style="{ \'background-image\': sticker.bgUrl ? \'url(\' + sticker.bgUrl + \')\' : \'\'}">\n    <div class="container">\n        <div class="row">\n\n            <div class="col-lg-7 text-shadow">\n\n                <span class="sticker" img="{{ sticker.design.imageUrl }}"></span>\n\n                <h1>{{ sticker.name }}</h1>\n\n                <ul class="sticker-info">\n                    <li ng-if="sticker.category"><i class="fa fa-folder"></i> Part of the\n                        <a href="/category/{{ sticker.category.slug }}"> {{ sticker.category.name }}</a> category\n                    </li>\n                    <li ng-if="sticker.creator"><i class="fa fa-user"></i> Added by\n                        <a href="/user/{{ sticker.creator.url }}">{{ sticker.creator.username }}</a></li>\n                </ul>\n\n                <p class="desc">{{ sticker.description }}</p>\n            </div>\n\n            <div class="col-lg-5">\n\n                <ul class="task-list">\n                    <li class="header"><h3>Complete {{ (sticker.requiredTasks ? sticker.requiredTasks : \'all\') }} tasks\n                        to earn the sticker.</small></h3></li>\n                    <li ng-repeat="task in sticker.tasks"><a href="/task/{{ task.slug }}">{{ task.name }}</a></li>\n                    <li></li>\n                    <li></li>\n                    <li></li>\n                    <li></li>\n                    <li></li>\n                </ul>\n\n            </div>\n\n        </div>\n    </div>\n</div>\n\n<div class="container">\n    <div class="row">\n\n        <div class="col-lg-7">\n\n\n            <h2><i class="fa fa-trophy"></i> Who\'s Got It</h2>\n            <ul ng-if="hasEarners">\n                <li><a href="/user/{{ user.username }}">{{ user.username }}</a></li>\n            </ul>\n            <p ng-if="!hasEarners" class="text-center"><i class="fa fa-frown-o"></i> Nobody yet!</p>\n\n\n            <ul class="posts">\n                <li>\n                    <p class="title">\n                        <i class="fa fa-question-circle"></i> <a href="#">Steve</a> needs help to <a href="#">Visit the\n                        Great Wall of China</a>.\n                        <span class="date">10 minutes ago.</span>\n                    </p>\n\n                    <p class="desc">&quot;How do I get there&quot;</p>\n\n                    <p><a class="btn btn-block"><i class="fa fa-commenting"></i> Help Steve</a></p>\n                </li>\n                <li>\n                    <p class="title">\n                        <i class="fa fa-check-square-o"></i> <a href="#">Anthony</a> completed <a href="#">Visit the\n                        Forbidden City</a>.\n                        <span class="date">18 months ago.</span>\n                    </p>\n\n                    <p class="desc">&quot;3/10 would not recommend&quot;</p>\n\n                    <p><a class="btn btn-block btn-primary"><i class="fa fa-smile-o"></i> Way to go, Anthony</a></p>\n                </li>\n            </ul>\n\n        </div>\n\n        <div class="col-lg-5">\n            <h2>More {{ sticker.category.name }} Stickers</h2>\n            <ul class="sticker-list small-sticker-list row">\n\n                <li class="col-xs-4 col-sm-3 col-lg-4"\n                    ng-repeat="catSticker in sticker.category.stickers"\n                    ng-if="catsticker.id != sticker.id">\n                    <a href="/sticker/{{ catSticker.slug }}">\n                        <span class="sticker" img="{{ catSticker.imageUrl }}"></span>\n                        <br/>{{ catSticker.name }}\n                    </a>\n                </li>\n\n            </ul>\n        </div>\n\n    </div>\n</div>\n</div>\n'),$templateCache.put("views/pages/task/submit.html","@extends('layouts.main')\n\n@section('breadcrumbs')\n{!! Breadcrumbs::render('task', $task) !!}\n@stop\n\n@section('content')\n<div class=\"container\">\n    <h1>{{ $task->name }}</h1>\n\n    <h2>Add Your Submission</h2>\n\n    <p><strong>To complete this task you must:</strong><br/>\n        {{ $task->submission }}\n    </p>\n\n    <form class=\"form-horizontal well\" method=\"post\" action=\"submit\">\n        {!! csrf_field() !!}\n\n        <div class=\"form-group <?=($errors->get('picture') ? 'has-error' : '')?>\">\n"+'            <label class="col-md-4 control-label">Picture <i class="fa fa-picture"></i></label>\n\n            <div class="col-md-8">\n                <input type="hidden"\n                       class="form-control"\n                       name="picture"\n                       value="{{ old(\'picture\') ? old(\'picture\') : \'\' }}"\n                       required/>\n                <?php\n                foreach ($errors->get(\'picture\') as $error) {\n                echo \'<span class="help-block">\' . $error . \'</span>\';\n                }\n                ?>\n                <a href="#" class="btn" id="task-submit-upload-picture-btn"><i class="fa fa-camera"></i> Upload a\n                    picture</a>\n\n                <img src="{{ old(\'picture\') ? old(\'picture\') : \'\' }}" id="task-submit-picture"/>\n\n            </div>\n        </div>\n\n        <div class="form-group">\n            <div class="col-md-8 col-md-offset-4">\n                <button type="submit" class="btn btn-success">Submit</button>\n            </div>\n        </div>\n\n    </form>\n</div>\n@endsection\n'),$templateCache.put("views/pages/task/view.html",'<div class="content">\n<div class="container pane-page" id="task-page" ng-if="task">\n\n    <div class="row">\n        <div class="col-md-5">\n\n            <h3 class="task-title-sticker">\n                <a href="/sticker/{{ task.sticker.slug }}">\n                    <span class="sticker sticker-sm" img="{{ task.sticker.design.imageUrl }}"></span>\n                    {{task.sticker.name }} Sticker\n                </a>\n            </h3>\n\n            <h1 class="task-title">{{ task.name }}</h1>\n\n            <div id="task-btns" class="pull-right">\n\n                <a class="btn btn-danger btn-remove-todo btn-labeled"\n                   href="#"\n                   ng-click="removeToDo()"\n                   ng-if="currentUser && isOnToDoList">\n                    <span class="btn-label"><i class="fa fa-minus-square-o"></i></span>\n                    Remove from your To Do List\n                </a>\n\n                <a class="btn btn-success btn-add-todo btn-labeled"\n                   href="#"\n                   ng-click="addToDo()"\n                   ng-if="currentUser && !isOnToDoList">\n                    <span class="btn-label"><i class="fa fa-plus-square-o"></i></span>\n                    Add to your To Do List\n                </a>\n\n            </div>\n\n            <ul id="task-details">\n                <li><strong>Cost</strong> <i class="fa fa-usd"></i><i class="fa fa-usd"></i><i class="fa fa-usd"></i>\n                </li>\n                <li><strong>Time</strong> 5 hours</li>\n                <li><strong>Type</strong> <i class="fa fa-user"></i> Alone <i class="fa fa-users"></i> Group\n                    <i class="fa fa-globe"></i> Travel\n                </li>\n            </ul>\n\n            <p>{{ task.description }}</p>\n\n        </div>\n\n        <div class="col-md-7">\n            <div class="posts-container">\n                <div ng-include="\'views/partials/post-form.html\'" ng-controller="PostFormController"></div>\n                <div ng-include="\'views/partials/post-list.html\'"></div>\n            </div>\n        </div>\n    </div>\n\n</div>\n\n\n<script>\n'+"    $(document).on('click', '#settings-upload-picture-btn', function () {\n        ctrlv.upload(function (image) {\n            $('input[name=picture]').val(image.urls.image);\n            $('#settings-picture').attr('src', image.urls.image);\n        });\n    })\n</script>\n</div>\n"),$templateCache.put("views/pages/user/stickers.html",'<div class="container">\n    <h1>{{ user.username }}\'s Stickers</h1>\n\n    <ul>\n        <li ng-repeat="sticker in stickers"><a href="/sticker/{{ sticker.slug }}">{{ sticker.name }}</a></li>\n    </ul>\n\n</div>\n'),
$templateCache.put("views/pages/user/todo.html",'<div class="container">\n    <h1>{{ user.username }}\'s To Do List</h1>\n\n    <ul>\n        <li ng-repeat="task in tasks"><a href="/task/{{ task.slug }}">{{ task.name }}</a></li>\n    </ul>\n\n</div>\n'),$templateCache.put("views/pages/user/view.html",'<div class="content">\n<div class="container">\n    <h1>{{ user.username }}</h1>\n\n    <img ng-src="{{ user.pictureUrl }}"/>\n\n    <h3>About {{ user.username }}</h3>\n\n    <p>{{ user.profile.about }}</p>\n\n</div>\n</div>\n'),$templateCache.put("views/partials/footer.html",'<footer>\n    <div class="container">\n        <div class="pull-left">\n            Footer goes here!\n        </div>\n        <div class="pull-right">\n            <a href="#">Link</a> &nbsp; | &nbsp;\n            <a href="#">Link</a>\n        </div>\n    </div>\n</footer>\n'),$templateCache.put("views/partials/header.html",'<header class="navbar" id="top-bar">\n    <div class="container">\n\n        <div class="navbar-header" ng-class="{\'has-title\':pageTitle}">\n\n            <a href="#" ng-click="back()" class="navbar-back"><i class="fa fa-chevron-left"></i></a>\n\n            <button type="button" class="navbar-toggle">\n                <span class="navbar-toggle-icon">\n                    <span></span>\n                </span>\n            </button>\n\n            <a ui-sref="home" class="navbar-brand"><span class="navbar-logo"></span></a>\n\n            <h1>{{ pageTitle }}</h1>\n        </div>\n\n\n        <nav role="navigation" id="top-bar-nav">\n\n            <ul class="nav navbar-nav">\n                <li class="hidden-lg"><a href="/"><i class="fa fa-home fa-fw"></i> Front Page</a></li>\n                <li><a href="/bot"><i class="fa fa-android fa-fw"></i> Stickerbot</a></li>\n                <li><a href="/browse"><i class="fa fa-folder fa-fw"></i> Browse</a></li>\n                <li><a ui-sref="help"><i class="fa fa-question fa-fw"></i> Help</a></li>\n            </ul>\n\n            <ul class="nav navbar-nav navbar-right nav-logged-in" ng-if="currentUser">\n\n                <li ng-if="currentUser.admin">\n                    <a href="http://admin.local.stickable.io"><i class="fa fa-tachometer fa-fw"></i> Admin</a></li>\n                <li><a href="/user/{{ currentUser.username }}/todo"><i class="fa fa-check-square-o fa-fw"></i> To Do\n                    List</a></li>\n                <li><a href="/user/{{ currentUser.username }}/stickers"><i class="fa fa-camera-retro fa-fw"></i> Your\n                    Submissions</a></li>\n                <li><a href="/user/{{ currentUser.username }}/stickers"><i class="fa fa-trophy fa-fw"></i> Your Stickers</a>\n                </li>\n\n                <li class="dropdown">\n                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">\n                        <span ng-show="notifications.length > 0" class="notification">{{ notifications.length }}</span>\n                        <i class="fa fa-envelope fa-fw"></i>\n                        <b class="caret"></b>\n                    </a>\n                    <ul class="dropdown-menu notifications-dropdown">\n                        <li ng-repeat="notification in notifications">\n                            <a>{{ notification.text }}</a>\n                        </li>\n                    </ul>\n                </li>\n\n                <li class="dropdown">\n                    <a class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user fa-fw"></i> {{\n                        currentUser.username }} <b class="caret"></b></a>\n                    <ul class="dropdown-menu">\n                        <li><a href="/user/{{ currentUser.username }}"><i class="fa fa-user fa-fw"></i> Profile</a></li>\n                        <li class="divider"></li>\n                        <li><a href="/settings"><i class="fa fa-cog fa-fw"></i> Settings</a></li>\n                        <li class="divider"></li>\n                        <li><a href="#" ng-click="logout()"><i class="fa fa-unlock-alt fa-fw"></i> Logout</a></li>\n                    </ul>\n                </li>\n            </ul>\n\n            <form class="navbar-form navbar-right visible-lg" ng-submit="login()" ng-if="currentUser === false">\n\n                <div class="form-group">\n                    <input id="header-username"\n                           type="text"\n                           class="form-control input-sm"\n                           name="username"\n                           placeholder="Username"\n                           ng-model="loginFormData.username"/>\n                </div>\n                <div class="form-group">\n                    <input id="header-password"\n                           type="password"\n                           class="form-control input-sm"\n                           name="password"\n                           placeholder="Password"\n                           ng-model="loginFormData.password"/>\n                </div>\n                <button id="header-login-btn" type="submit" class="btn btn-primary"><i class="fa fa-key fa-fw"\n                                                                                       ng-hide="loginFormData.loading"></i><i\n                        class="fa fa-spinner fa-spin fa-fw"\n                        ng-show="loginFormData.loading"></i> Login\n                </button>\n                <a class="btn" href="/signup"><i class="fa fa-user fa-fw"></i> Signup</a>\n            </form>\n            <ul class="nav navbar-nav navbar-right nav-logged-out" ng-if="currentUser === false">\n                <li class="hidden-lg"><a href="/login"><i class="fa fa-key fa-fw"></i> Login</a></li>\n                <li class="hidden-lg"><a href="/signup"><i class="fa fa-user fa-fw"></i> Signup</a></li>\n            </ul>\n\n\n        </nav>\n    </div>\n</header>\n'),$templateCache.put("views/partials/post-form.html",'<div class="form-group tabs tabs-style-linemove to-edge">\n    <nav>\n        <ul>\n            <li ng-class="{\'tab-current\': type === \'submission\' }">\n                <a href="#" ng-click="setType(\'submission\')" class="icon icon-home">\n                    <span><i class="fa fa-fw fa-check-square"></i> Submissions</span>\n                </a>\n            </li>\n            <li ng-class="{\'tab-current\': type === \'tip\' }">\n                <a href="#" ng-click="setType(\'tip\')" class="icon icon-box">\n                    <span><i class="fa fa-fw fa-info-circle"></i> Tips</span>\n                </a>\n            </li>\n            <li ng-class="{\'tab-current\': type === \'question\' }">\n                <a href="#" ng-click="setType(\'question\')" class="icon icon-display">\n                    <span><i class="fa fa-fw fa-question-circle"></i> Questions</span>\n                </a>\n            </li>\n        </ul>\n    </nav>\n</div>\n\n<div ng-show="!type || type === \'submission\'" class="ng-hide alert alert-info to-edge">\n    <label><i class="fa fa-check-square"></i> To complete this task and earn credit towards the <strong>{{ task.sticker.name }}</strong> sticker, {{ task.submission }}</label>\n    <a class="btn btn-block">Submit Your Photo</a>\n</div>\n\n<div ng-show="type === \'tip\'" class="ng-hide alert alert-info to-edge">\n    <a class="btn btn-block">Add A Tip</a>\n</div>\n\n<div ng-show="type === \'question\'" class="ng-hide alert alert-info to-edge">\n    <a class="btn btn-block">Need Help? Ask A Question</a>\n</div>\n\n\n<!--<form class="ng-hide post-form form to-edge" ng-submit="submit()" ng-show="type">\n\n    <div ng-if="type === \'submission\'" ng-include="\'views/partials/submission-forms/\' + task.submissionType.toLowerCase() + \'.html\'"></div>\n\n    <div ng-if="type" class="form-group">\n        <textarea class="form-control" ng-model="formData.comment" placeholder="Comment goes here"></textarea>\n    </div>\n\n    <div ng-if="type" class="form-group text-right">\n        <button class="btn btn-primary">Submit</button>\n    </div>\n\n</form> -->\n'),$templateCache.put("views/partials/post-list.html",'<ul class="posts media-list to-edge">\n    <li class="media" ng-repeat="post in posts.posts" ng-class="{\'with-task\': !!showPostTasks}">\n        <span class="media-left media-middle">\n            <a href="/task/{{ post.task.slug }}/{{ post.slug }}">\n                <img class="media-object" ng-src="{{ post.image }}"/>\n            </a>\n        </span>\n        <span class="media-body media-middle">\n            <h4 ng-if="showPostTasks"><i class="fa fa-check-square-o"></i> {{ post.task.name }}</h4>\n            <h3>\n                <a href="/task/{{ post.task.slug }}/{{ post.slug }}">{{ post.title }}</a>\n            </h3>\n            <span class="details">\n                <i class="fa fa-user"></i> {{ post.user.username }}\n                <i class="fa fa-comment"></i> {{ post.commentCount }} comments\n                <i class="fa fa-heart"></i> {{ post.likeCount }} likes\n            </span>\n        </span>\n    </li>\n</ul>\n'),$templateCache.put("views/partials/submission-forms/image.html",'<!--<p class="submission-help">You can either show yourself in the photo, or your username should be in the photo (on a piece of paper for example, not added afterwards). Your photo will only be made public if you choose to do so. Our moderators will check the photo to ensure it meets the requirements of this task.</p>-->\n<a class="btn btn-labeled btn-block ctrlv-btn"><span class="btn-label"><i class="fa fa-camera"></i></span> Submit\n    A Photo</a>\n'),$templateCache.put("views/partials/submission-forms/text.html",'<textarea placeholder="Write stuff here." ng-model="submissionFormData.text"></textarea>\n')}]),Messenger.options={extraClasses:"messenger-fixed messenger-on-top messenger-on-right",theme:"flat"},app.controller("BotController",function($scope,$rootScope){$rootScope.pageTitle=""}),app.controller("BrowseController",function($scope,$rootScope,CategoryResource){$rootScope.pageTitle="",$scope.categories=CategoryResource.query()}),app.controller("CategoryController",function($scope,$rootScope,$state,$stateParams,$element,CategoryResource){$rootScope.loading=!0,$scope.category=null,$scope.hasSubcategories=!1,$scope.hasStickers=!1,$rootScope.pageTitle="",CategoryResource.get({slug:$stateParams.slug},function(category){$scope.category=category,$rootScope.pageTitle=category.name,$scope.hasSubcategories=category.subcategories.length>0,$scope.hasStickers=category.stickers.length>0,$element.css("background-image","url("+category.bgUrl+")")})}),app.controller("HomeController",function($scope,$rootScope,CategoryResource,PostResource){$rootScope.pageTitle="",$scope.splashImage="http://img.ctrlv.in/img/16/01/21/56a06452057e0.png",$scope.showPostTasks=!0,$scope.posts=PostResource.query()}),app.controller("SettingsController",function($scope,$rootScope,$state,$stateParams,AuthService,UserResource){$rootScope.pageTitle="Settings",$rootScope.loading=!0,$scope.settingsFormData={loading:!1,about:"",picture:""},$scope.user=null,UserResource.get({username:$rootScope.currentUser.username},function(user){$rootScope.loading=!1,$scope.user=user,$scope.settingsFormData.about=user.profile.about,$scope.settingsFormData.picture=user.picture}),$scope.uploadPicture=function(){alert("CtrlV upload would go here/")},$scope.submit=function(){$scope.settingsFormData.loading=!0,UserResource.update({username:$rootScope.currentUser.username},{picture:$scope.settingsFormData.picture,about:$scope.settingsFormData.about},function(response){$scope.settingsFormData.loading=!1,alertSuccess("Changes saved")},function(response){$scope.settingsFormData.loading=!1,response.data.messages&&(response.data.messages.hasOwnProperty("picture")||response.data.messages.hasOwnProperty("about"))?$scope.settingsFormData.errors=response.data.messages:alertError(response.data.message)})}}),app.controller("StickerController",function($scope,$rootScope,$state,$stateParams,StickerResource){$rootScope.pageTitle="Settings",$rootScope.loading=!0,$scope.sticker=null,$scope.hasEarners=!1,StickerResource.get({slug:$stateParams.slug},function(sticker){$rootScope.loading=!1,$rootScope.pageTitle=sticker.name,$scope.sticker=sticker,$scope.hasEarners=sticker.earners.length>0})}),app.controller("TaskController",function($scope,$rootScope,$element,$state,$stateParams,TaskResource,SubmissionResource,UserToDoResource,PostResource){$rootScope.pageTitle="",$rootScope.loading=!0,$scope.task=null,$scope.isOnToDoList=!1,TaskResource.get({slug:$stateParams.slug},function(task){$rootScope.loading=!1,$rootScope.pageTitle=task.name,$scope.task=task,$scope.isOnToDoList=$scope.task.isOnToDoList,$element.css("background-image","url("+task.bgUrl+")")}),$scope.showPostTasks=!1,$scope.postType=null,$scope.posts=PostResource.getTaskPosts({taskSlug:$stateParams.slug},{type:$scope.postType}),$scope.addToDo=function(){console.log("addToDo"),UserToDoResource.save({username:$rootScope.currentUser.username},{taskId:$scope.task.id},function(result){alertSuccess("Added to To Do List"),$scope.isOnToDoList=!0},function(result){alertError(result.data.message)})},$scope.removeToDo=function(){UserToDoResource["delete"]({username:$rootScope.currentUser.username},{taskId:$scope.task.id},function(result){alertSuccess("Removed from To Do List"),$scope.isOnToDoList=!1},function(result){alertError(result.data.message)})},$scope.submissionFormData={loading:!1,text:"",image:""},$scope.addSubmission=function(){$scope.submissionFormData.loading=!0,SubmissionResource.save({taskId:$scope.task.id,text:$scope.submissionFormData.text,image:$scope.submissionFormData.image},function(response){},function(response){alertError(response.data.message)})},$scope.addComment=function(){}}),app.controller("ForgotController",function($scope,$state,$stateParams,UserResource){$scope.forgotFormData={loading:!1,email:"",errors:{}},$scope.success=!1,$scope.submit=function(){return $scope.forgotFormData.loading=!0,UserResource.forgot({},{email:$scope.forgotFormData.email},function(response){$scope.forgotFormData.loading=!1,$scope.success=!0},function(response){$scope.forgotFormData.loading=!1,response.data.messages&&response.data.messages.hasOwnProperty("email")?$scope.forgotFormData.errors=response.data.messages:alertError(response.data.message)}),!1}}),app.controller("LoginController",function($scope,$state,$stateParams,AuthService){$scope.loginFormData={loading:!1,username:"",password:"",errors:{}},$scope.login=function(){return $scope.loginFormData.loading=!0,AuthService.login($scope.loginFormData.username,$scope.loginFormData.password).then(function(response){$scope.loginFormData.loading=!1,$state.go("home")},function(response){$scope.loginFormData.loading=!1,$scope.sortLoginErrors(response)}),!1},$scope.sortLoginErrors=function(response){response.messages&&(response.messages.hasOwnProperty("username")||response.messages.hasOwnProperty("password"))?$scope.loginFormData.errors=response.messages:$scope.loginFormData.errors={general:response.message}},$stateParams.loginFormData&&($scope.loginFormData=$stateParams.loginFormData),$stateParams.response&&$scope.sortLoginErrors($stateParams.response)}),app.controller("ResetController",function($scope,$state,$stateParams,UserResource){$scope.resetFormData={loading:!1,token:$stateParams.token,password:"",confirmPassword:"",errors:{}},$scope.success=!1,$scope.submit=function(){return $scope.resetFormData.password!=$scope.resetFormData.confirmPassword?($scope.resetFormData.errors={confirmPassword:["Passwords do not match."]},!1):($scope.resetFormData.loading=!0,UserResource.reset({},{token:$scope.resetFormData.token,password:$scope.resetFormData.password},function(response){$scope.resetFormData.loading=!1,$scope.success=!0},function(response){$scope.resetFormData.loading=!1,response.data.messages&&response.data.messages.hasOwnProperty("password")?$scope.resetFormData.errors=response.data.messages:alertError(response.data.message)}),!1)}}),app.controller("SignupController",function($scope,$state,AuthService,UserResource){$scope.signupFormData={loading:!1,username:"",password:"",email:"",errors:{}},$scope.signup=function(){return $scope.signupFormData.loading?!1:($scope.signupFormData.errors={},$scope.signupFormData.loading=!0,void UserResource.save({username:$scope.signupFormData.username,password:$scope.signupFormData.password,email:$scope.signupFormData.email},function(response){AuthService.login($scope.signupFormData.username,$scope.signupFormData.password).then(function(response){$scope.signupFormData.loading=!1,$state.go("home")},function(response){$scope.signupFormData.loading=!1,$scope.signupFormData.errors={general:response.message}})},function(response){$scope.signupFormData.loading=!1,response=response.data,response.messages&&(response.messages.hasOwnProperty("username")||response.messages.hasOwnProperty("password")||response.messages.hasOwnProperty("email"))?$scope.signupFormData.errors=response.messages:$scope.signupFormData.errors={general:response.message}}))}}),app.controller("CommentFormController",function($scope,$rootScope,$state,$stateParams,CommentResource){$scope.task=$scope.$parent.task,$scope.commentFormData={loading:!1,comment:""},$scope.addComment=function(){$scope.commentFormData.loading=!0,CommentResource.save({taskId:$scope.task.id,comment:$scope.commentFormData.comment},function(response){console.log(response),$scope.$parent.comments.unshift(response.comment)},function(response){alertError(response.data.message)})}}),app.controller("HeaderController",function($scope,$state,ModalService,AuthService){$scope.loginFormData={loading:!1,username:"",password:"",errors:{}},$scope.login=function(){return $scope.loginFormData.loading=!0,console.log($scope),AuthService.login($scope.loginFormData.username,$scope.loginFormData.password).then(function(response){$scope.loginFormData.loading=!1},function(response){$scope.loginFormData.loading=!1,console.log("passing to login",{loginFormData:$scope.loginFormData,response:response}),$state.go("login",{loginFormData:$scope.loginFormData,response:response})}),!1},$scope.logout=function(){AuthService.logout()},$scope.back=function(){window.history.go(-1)}}),app.controller("PostFormController",function($scope,$rootScope,$state,$stateParams,PostResource){alert($scope.postType),$scope.task=$scope.$parent.task,$scope.formData={loading:!1,comment:""},$scope.postType="",$scope.setPostType=function(postType){$scope.postType=postType===$scope.postType?"":postType},$scope.addComment=function(){$scope.formData.loading=!0,CommentResource.save({taskId:$scope.task.id,comment:$scope.formData.comment},function(response){console.log(response),$scope.$parent.comments.unshift(response.comment)},function(response){alertError(response.data.message)})}}),app.controller("UserProfileController",function($scope,$rootScope,$state,$stateParams,AuthService,UserResource){$rootScope.loading=!0,$rootScope.pageTitle=$stateParams.username,$scope.username=$stateParams.username,$scope.user=UserResource.get({username:$scope.username})}),app.controller("UserStickersController",function($scope,$rootScope,$state,$stateParams,UserResource){$rootScope.loading=!0,$rootScope.pageTitle=$stateParams.username,$scope.user=null,$scope.username=$stateParams.username,$scope.stickers=[],UserResource.getStickers({username:$scope.username},function(result){$scope.user=result.user,$scope.stickers=result.stickers})}),app.controller("UserSubmissionsController",function($scope,$rootScope,$state,$stateParams,UserResource){$rootScope.loading=!0,$rootScope.pageTitle=$stateParams.username,$scope.submissions=[],$scope.user=null,$scope.username=$stateParams.username,UserResource.getSubmissions({username:$scope.username},function(result){$scope.user=result.user,$scope.submissions=result.submissions})}),app.controller("UserToDoController",function($scope,$rootScope,$state,$stateParams,UserResource,UserToDoResource){$rootScope.loading=!0,$rootScope.pageTitle=$stateParams.username,$scope.tasks=[],$scope.user=null,$scope.username=$stateParams.username,UserToDoResource.query({username:$scope.username},function(result){$scope.user=result.user,$scope.tasks=result.tasks})}),app.directive("sticker",function(){return{restrict:"C",link:function($scope,element){$scope.$watch("img",function(newValue,oldValue){newValue&&(console.log("img",newValue),Sticker.init(element[0]),element.find(".sticker-img").css("background-image","url("+$scope.img+")"))})},scope:{img:"@"}}}),Array.prototype.shuffle=function(){var j,temp,i=this.length;if(0===i)return this;for(;--i;)j=Math.floor(Math.random()*(i+1)),temp=this[i],this[i]=this[j],this[j]=temp;return this},app.factory("CategoryResource",function($resource,AuthService){return $resource(apiUrl+"categories/:slug",{slug:"@slug",sessionToken:function(){return AuthService.getSessionToken()||null}},{get:{cache:!0,transformResponse:function(data){return data=angular.fromJson(data),data.category}},query:{cache:!0,isArray:!0,transformResponse:function(data){return data=angular.fromJson(data),data.categories}}})}),app.factory("CommentResource",function($resource,AuthService){return $resource(apiUrl+"comments/:commentId",{commentId:"@commentId",postId:"@postId",sessionToken:function(){return AuthService.getSessionToken()||null}},{getPostsComments:{method:"GET",url:apiUrl+"posts/:postId/comments",isArray:!0},getCommentReplies:{method:"GET",url:apiUrl+"comments/:commentId/replies",isArray:!0}})}),app.factory("PostResource",function($resource,AuthService){return $resource(apiUrl+"posts/:id",{id:"@id",taskSlug:"@taskSlug",sessionToken:function(){return AuthService.getSessionToken()||null}},{query:{},getTaskPosts:{method:"GET",url:apiUrl+"tasks/:taskSlug/posts"},get:{cache:!0,transformResponse:function(data){return data=angular.fromJson(data),data.post}}})}),app.factory("SessionResource",function($resource){return $resource(apiUrl+"sessions",{sessionToken:"@sessionToken"},{get:{transformResponse:function(data){return data=angular.fromJson(data),data.session}}})}),app.factory("StickerResource",function($resource,AuthService){return $resource(apiUrl+"stickers/:slug",{slug:"@slug",sessionToken:function(){return AuthService.getSessionToken()||null}},{get:{cache:!0,transformResponse:function(data){return data=angular.fromJson(data),data.sticker}}})}),app.factory("SubmissionResource",function($resource,AuthService){return $resource(apiUrl+"submissions/:submissionId",{submissionId:"@submissionId",taskSlug:"@taskSlug",sessionToken:function(){return AuthService.getSessionToken()||null}},{save:{method:"POST",url:apiUrl+"tasks/:taskSlug/submissions"}})}),app.factory("TaskResource",function($resource,AuthService){return $resource(apiUrl+"tasks/:slug",{slug:"@slug",sessionToken:function(){return AuthService.getSessionToken()||null}},{get:{cache:!0,transformResponse:function(data){return data=angular.fromJson(data),data.task}}})}),app.factory("UserNotificationsResource",function($resource,AuthService){return $resource(apiUrl+"users/:username/notifications/:id",{username:"@username",sessionToken:function(){return AuthService.getSessionToken()||null}},{query:{method:"GET",isArray:!0,transformResponse:function(data){var data=angular.fromJson(data);return data.notifications}}})}),app.factory("UserResource",function($resource,AuthService){return $resource(apiUrl+"users",{username:"@username",sessionToken:function(){return AuthService.getSessionToken()||null}},{get:{url:apiUrl+"users/:username",cache:!0,transformResponse:function(data){var data=angular.fromJson(data);return data.user}},update:{method:"PUT",url:apiUrl+"users/:username"},save:{method:"POST"},forgot:{method:"POST",url:apiUrl+"users/forgot"},reset:{method:"POST",url:apiUrl+"users/reset"},getStickers:{method:"GET",url:apiUrl+"users/:username/stickers"},getSubmissions:{method:"GET",url:apiUrl+"users/:username/submissions"}})}),app.factory("UserToDoResource",function($resource,AuthService){return $resource(apiUrl+"users/:username/todo",{username:"@username",slug:"@slug",taskId:"@taskId",sessionToken:function(){return AuthService.getSessionToken()||null}},{query:{method:"GET"},"delete":{method:"DELETE",url:apiUrl+"users/:username/todo/:taskId"}})}),app.service("AuthService",function(localStorageService,SessionResource,$q,$rootScope){var session=null,sessionToken=null;return{checkSession:function(){var self=this;(sessionToken=localStorageService.get("sessionToken"))?SessionResource.get({sessionToken:sessionToken},function(session){self.onLogin(session,sessionToken)},function(response){400===response.status?self.onLogout():alertError("There was an error logging in to Stickable. Please refresh to try again.")}):self.onLogout()},login:function(username,password){var self=this;return $q(function(resolve,reject){SessionResource.save({username:username,password:password},function(response){self.onLogin(response.session,response.sessionToken),resolve(response.session.user)},function(response){reject(response.data)})})},onLogin:function(newSession,newSessionKey){session=newSession,sessionToken=newSessionKey,localStorageService.set("sessionToken",newSessionKey),console.log("onLogin",newSession),$rootScope.$broadcast("login",{user:newSession.user})},logout:function(){var self=this;SessionResource["delete"]({sessionToken:sessionToken}),self.onLogout()},onLogout:function(){session=!1,sessionToken=!1,localStorageService.remove("sessionToken"),$rootScope.$broadcast("logout")},getSessionToken:function(){return sessionToken},getUser:function(){return null===session?null:session&&session.user?session.user:!1}}});
//# sourceMappingURL=stickable.min.js.map